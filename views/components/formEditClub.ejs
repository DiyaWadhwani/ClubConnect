<h2 class="text-center mt-20">
  <%= club.name %>
</h2>

<div class="card shadow-sm p-4 mx-auto" style="max-width: 600px">
  <form action="<%= '/clubs/' + club.club_id + '/edit' %>" method="POST">

    <!-- Club Name Field (Disabled) -->
    <div class="mb-4">
      <label class="form-label fw-bold">Club Name:</label>
      <input class="form-control" type="text" name="name" value="<%= club.name %>" placeholder="Club Name" disabled />
      <input type="hidden" name="name" value="<%= club.name %>" />
    </div>

    <!-- Description Field (Editable) -->
    <div class="mb-4">
      <label class="form-label fw-bold">Description:</label>
      <textarea class="form-control" name="description" rows="3" placeholder="Enter club description" <%=isCoreMember
        ? 'required' : 'disabled' %>><%= club.description %></textarea>
    </div>

    <!-- Start Date Field (Disabled) -->
    <div class="mb-4">
      <label class="form-label fw-bold">Start Date:</label>
      <input class="form-control" type="date" name="start_date" value="<%= club.start_date %>" placeholder="Start Date"
        disabled />
      <input type="hidden" name="start_date" value="<%= club.start_date %>" />
    </div>

    <!-- Email Field (Editable) -->
    <div class="mb-4">
      <label class="form-label fw-bold">Email:</label>
      <input class="form-control" type="email" name="email" value="<%= club.email %>" placeholder="Enter club email"
        <%=isCoreMember ? 'required' : 'disabled' %> />
    </div>

    <!-- Logo URL Field (Editable) -->
    <div class="mb-4">
      <label class="form-label fw-bold">Logo URL:</label>
      <input class="form-control" name="logo" value="<%= club.logo %>" placeholder="https://example.com/logo.png"
        <%=isCoreMember ? '' : 'disabled' %> />
    </div>

    <!-- University Name Field (Disabled) -->
    <div class="mb-4">
      <label class="form-label fw-bold">University Name:</label>
      <input class="form-control" type="text" name="name" value="<%= university.name %>" placeholder="University Name"
        disabled />
    </div>

    <!-- Club Category Field (Editable) -->
    <div class="mb-4">
      <label class="form-label fw-bold">Club Category:</label>
      <select class="form-select" name="category" id="category" onchange="handleCategoryChange()" <%=isCoreMember
        ? 'required' : 'disabled' %>>
        <option value="" <%=!club.category ? 'selected' : '' %> disabled>Select a category</option>
        <option value="Technology" <%=club.category && club.category.trim().toLowerCase()==='technology' ? 'selected'
          : '' %>>Technology</option>
        <option value="Arts" <%=club.category && club.category.trim().toLowerCase()==='arts' ? 'selected' : '' %>>Arts
        </option>
        <option value="Sports" <%=club.category && club.category.trim().toLowerCase()==='sports' ? 'selected' : '' %>
          >Sports</option>
        <option value="Music" <%=club.category && club.category.trim().toLowerCase()==='music' ? 'selected' : '' %>
          >Music</option>
        <option value="Literature" <%=club.category && club.category.trim().toLowerCase()==='literature' ? 'selected'
          : '' %>>Literature</option>
        <option value="Other" <%=club.category && !['technology', 'arts' , 'sports' , 'music' , 'literature'
          ].includes(club.category.trim().toLowerCase()) ? 'selected' : '' %>>Other</option>
      </select>
    </div>

    <div class="mb-4" id="other_category">
      <label class="form-label fw-bold">Specify Other Category:</label>
      <input type="text" class="form-control" name="other_category"
        value="<%= club.category && !['technology', 'arts', 'sports', 'music', 'literature'].includes(club.category.trim().toLowerCase()) ? club.category : '' %>"
        <%=isCoreMember ? '' : 'disabled' %>/>
    </div>



    <!-- Cancel and Update Buttons -->
    <% if (isCoreMember) { %>
      <div class="d-flex justify-content-between mt-4">
        <a class="btn btn-danger" href="<%= '/clubs' %>">Cancel</a>
        <button type="submit" class="btn btn-primary">Update</button>
      </div>
      <% } %>
  </form>
</div>


<!-- Script to handle the club category dropdown -->
<script>
  function handleCategoryChange() {
    const categorySelect = document.getElementById("category");
    const customCategoryField = document.getElementById("other_category");
    const otherCategoryInput = customCategoryField.querySelector("input");

    if (categorySelect.value === "Other") {
      customCategoryField.style.display = "block";
      otherCategoryInput.required = true;
    } else {
      customCategoryField.style.display = "none";
      otherCategoryInput.value = "";
      otherCategoryInput.required = false;
    }
  }

  // Set initial display state on page load
  document.addEventListener("DOMContentLoaded", function () {
    const categorySelect = document.getElementById("category");
    const customCategoryField = document.getElementById("other_category");
    const clubCategory = "<%= club.category ? club.category.trim().toLowerCase() : '' %>";
    if (!["technology", "arts", "sports", "music", "literature"].includes(clubCategory) && clubCategory) {
      customCategoryField.style.display = "block";
      customCategoryField.querySelector("input").required = true;
    } else {
      customCategoryField.style.display = "none";
      customCategoryField.querySelector("input").required = false;
    }
  });
</script>